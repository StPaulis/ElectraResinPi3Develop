version: '2.1'
services:
  Router:
    build: ./Router
    privileged: true
    network_mode: "host"
    expose: 
      - "5672"
    depends_on:
      - RabbitMQ
    labels:
      io.balena.features.supervisor-api: '1'  
  Power:
    build: ./Power
    privileged: true
    network_mode: "host"
    depends_on:
      - RabbitMQ
    labels:
      io.balena.features.supervisor-api: '1'    
  Rabbitmq:
    image: bitnami/rabbitmq:latest
    ports:
        - "5672:5672"
        - "15672:15672"
    environment:
        RABBITMQ_USERNAME: "guest"
        RABBITMQ_PASSWORD: "guest"
    labels:
      io.balena.features.supervisor-api: '1'
